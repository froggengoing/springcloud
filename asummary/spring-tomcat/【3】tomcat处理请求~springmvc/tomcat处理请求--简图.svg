<svg viewBox="0 0 3377 1597" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xlink="http://www.w3.org/1999/xlink" height="1597" width="3377" xmlns="http://www.w3.org/2000/svg"><style type="text/css"><![CDATA[
.st4 {fill:#000000;font-family:宋体;font-size:15pt}
.st2 {fill:#000000;font-family:宋体;font-size:16pt}
.st1 {fill:#ffffff;font-family:宋体;font-size:16pt}
.st6 {fill:#ffffff;font-family:宋体;font-size:20pt}
.st5 {fill:#ffffff;font-family:宋体;font-size:24pt}
.st3 {font-size:20pt;font-weight:bold}
]]></style><defs/><g transform="translate(5,5)" id="page1"><rect y="0" x="0" stroke="#808080" fill="#ffffff" height="1587" width="3368"/><g transform="translate(47,257.5)"><path stroke="#ff0000" d="M1725,946.3L1725,0L0,0L0,946.3L1725,946.3z" fill="#ffc000" stroke-width="6.66667" id="shape1" fill-opacity="0"/></g><g transform="translate(89,244.75)"><path stroke="#3498db" d="M0,49L0,0L402,0L402,49C335.3,39.7,267.7,39.7,201,49C134.3,58.3,66.7,58.3,0,49z" fill="#ff0000" id="shape2"/><text class="st1"><tspan y="36" x="152">Connector</tspan></text></g><g transform="translate(95,338)"><path stroke="#92d050" d="M1658,846.8L1658,0L0,0L0,846.8L1658,846.8z" fill="#92d050" stroke-width="6.66667" id="shape3" fill-opacity="0"/></g><g transform="translate(95,431.25)"><path stroke="#ee7c31" d="M1063,743.5L1063,0L0,0L0,743.5L1063,743.5z" fill="#e8eff8" stroke-width="5.33333" id="shape4" fill-opacity="0"/></g><g transform="translate(95,329.75)"><path stroke="#3498db" d="M0,49L0,0L396,0L396,49C330.3,39.7,263.7,39.7,198,49C132.3,58.3,65.7,58.3,0,49z" fill="#92d050" id="shape5"/><text class="st1"><tspan y="36" x="105">Http11NioProtocol</tspan></text></g><g transform="translate(95,431.25)"><path stroke="#3498db" d="M0,49L0,0L368,0L368,49C307,39.7,245,39.7,184,49C123,58.3,61,58.3,0,49z" fill="#3498db" id="shape6"/><text class="st1"><tspan y="36" x="124">NioEndpoint</tspan></text></g><g transform="translate(118,957.01)"><path stroke="#ffaf00" d="M609,189L609,0L0,0L0,189L609,189z" fill="#92d050" id="shape7"/><text class="st2"><tspan y="33" x="4" class="st3">NioSelectorPool</tspan><tspan y="58" x="4">NioSelectorPool selectorPool = new NioSelectorPool();</tspan><tspan y="82" x="4">NioBlockingSelector blockingSelector=new </tspan><tspan y="106" x="4">NioBlockingSelector();</tspan><tspan y="130" x="4">volatile Selector sharedSelector=Selector.open();;</tspan><tspan y="154" x="4">NioBlockingSelector：</tspan><tspan y="178" x="4">BlockPoller poller=new BlockPoller();</tspan></text></g><g transform="translate(118,600.25)"><path stroke="#ffaf00" d="M498,73L498,0L0,0L0,73L498,73z" fill="#92d050" id="shape8"/><text class="st4"><tspan y="44" x="4">poller = new Poller();</tspan></text></g><g transform="translate(118,495.25)"><path stroke="#ffaf00" d="M498,78L498,0L0,0L0,78L498,78z" fill="#92d050" id="shape9"/><text class="st4"><tspan y="46.5" x="4">acceptor = new Acceptor&lt;>(this);</tspan></text></g><g transform="translate(620.55,920.25)" id="shape10"><path stroke="#ffc000" d="M0,0L556.4,0L556.4,-461L574.3,-461" fill="none" stroke-width="5.33333"/><path stroke="#ffc000" d="M584.4,-461L572.4,-467.9C573.6,-465.9,574.3,-463.5,574.3,-461C574.3,-458.5,573.6,-456.1,572.4,-454.1L584.4,-461" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(1205,431.25)"><path stroke="#3498db" d="M511,56L511,0L0,0L0,56L511,56z" fill="#3498db" id="shape11"/><text class="st1"><tspan y="36" x="69">AbstractProtocol.ConnectionHandler</tspan></text></g><g transform="translate(118,797.25)"><path stroke="#ffaf00" d="M498,73L498,0L0,0L0,73L498,73z" fill="#92d050" id="shape12"/><text class="st4"><tspan y="44" x="4">PollEvent</tspan></text></g><g transform="translate(711.01,495.25)"><path stroke="#ffaf00" d="M0,49L0,0L307,0L307,49C256.3,39.7,204.2,39.7,153.5,49C102.8,58.3,50.7,58.3,0,49z" fill="#92d050" id="shape13"/><text class="st4"><tspan y="35.5" x="4">accept新的连接</tspan></text></g><g transform="translate(625.01,580.25)"><path stroke="#ffaf00" d="M0,148.8L0,0L492,0L492,148.8C412.4,120.4,325.6,120.4,246,148.8C166.4,177.1,79.6,177.1,0,148.8z" fill="#92d050" id="shape14"/><text class="st2"><tspan y="45" x="4">单独线程调用run()</tspan><tspan y="69" x="4">1、调用pollevent，完成register</tspan><tspan y="93" x="4">2、selector.selector()，接收事件</tspan><tspan y="117" x="4">3、调用AbstractEndpoint#processSocket，获取</tspan><tspan y="141" x="4">SocketProcessor，并交给executor</tspan></text></g><g transform="translate(625.01,797.21)"><path stroke="#ffaf00" d="M0,63.9L0,0L492,0L492,63.9C410.5,51.7,327.5,51.7,246,63.9C164.5,76.1,81.5,76.1,0,63.9z" fill="#92d050" id="shape15"/><text class="st4"><tspan y="44" x="4">把socketChannel注册resister到selector</tspan></text></g><g transform="translate(118,892.25)"><path stroke="#ffaf00" d="M502.6,56L502.6,0L0,0L0,56L502.6,56z" fill="#92d050" id="shape16"/><text class="st4"><tspan y="35.5" x="4.3">exexutor线程池：执行SocketProcessor，调用Handler</tspan></text></g><g transform="translate(625.01,495.25)"><path stroke="#ffaf00" d="M0,49L0,0L492,0L492,49C410.3,39.7,327.7,39.7,246,49C164.3,58.3,81.7,58.3,0,49z" fill="#92d050" id="shape17"/><text class="st2"><tspan y="36" x="4">accept新的连接</tspan></text></g><g transform="translate(1460.5,487.25)" id="shape18"><path stroke="#ffc000" d="M0,0L0,34.2" fill="none" stroke-width="6.66667"/><path stroke="#ffc000" d="M0,45.5L7.7,32.1C5.5,33.4,2.8,34.2,0,34.2C-2.8,34.2,-5.5,33.4,-7.7,32.1L0,45.5" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(1205,532.75)"><path stroke="#3498db" d="M511,56L511,0L0,0L0,56L511,56z" fill="#3498db" id="shape19"/><text class="st1"><tspan y="24" x="47">AbstractHttp11Protocol#createProcessor</tspan><tspan y="48" x="152">==》Http11Processor</tspan></text></g><g transform="translate(1460.5,588.75)" id="shape20"><path stroke="#ffc000" d="M0,0L0,47.4" fill="none" stroke-width="6.66667"/><path stroke="#ffc000" d="M0,58.8L7.7,45.3C5.5,46.7,2.8,47.4,0,47.4C-2.8,47.4,-5.5,46.7,-7.7,45.3L0,58.8" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(1205,647.5)"><path stroke="#3498db" d="M511,56L511,0L0,0L0,56L511,56z" fill="#3498db" id="shape21"/><text class="st1"><tspan y="36" x="184">CoyoteAdapter</tspan></text></g><g transform="translate(1790.5,258.75)"><path stroke="#ff0000" d="M1554.5,945L1554.5,0L0,0L0,945L1554.5,945z" fill="#ffc000" stroke-width="6.66667" id="shape22" fill-opacity="0"/></g><path stroke="#ffaf00" transform="translate(280,672.75)" d="M3.8,108.5C3.6,118.6,0,124,0,124C0,124,5.8,120.2,12.4,119.4C12.4,120,8.5,117.7,8.5,117.7C8.5,117.7,43.9,74.6,46,0C37.4,78.5,5.7,114,5.7,114C5.7,114,3.8,108.9,3.8,108.5z" fill="#ffaf00" id="shape23"/><path stroke="#ffaf00" transform="matrix(0.77,-0.64,0.64,0.77,300.5,690.7)" d="M3.8,220.1C3.6,240.6,0,251.7,0,251.7C0,251.7,5.8,244,12.4,242.4C12.4,243.6,8.5,238.9,8.5,238.9C8.5,238.9,43.9,151.3,46,0C37.4,159.4,5.7,231.5,5.7,231.5C5.7,231.5,3.8,221.1,3.8,220.1z" fill="#ffaf00" id="shape24"/><g transform="translate(1914,277.75)"><path stroke="#ffc000" d="M1421,907L1421,0L0,0L0,907L1421,907z" fill="#3498db" stroke-width="6.66667" id="shape25" fill-opacity="0"/></g><g transform="translate(1460.5,703.5)" id="shape26"><path stroke="#ffc000" d="M0,0L0,112.3L349.5,112.3L349.5,-28L470.2,-28" fill="none" stroke-width="6.66667"/><path stroke="#ffc000" d="M481.5,-28L468.1,-35.7C469.4,-33.5,470.2,-30.8,470.2,-28C470.2,-25.2,469.4,-22.5,468.1,-20.3L481.5,-28" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(1451,825.75)"><g id="shape27"><path d="M293,151L293,0L0,0L0,151L293,151z" fill="#ffc000"/><path stroke="#83b3e3" d="M293,151L293,0L0,0L0,151L293,151zM14,151L14,0L14,151zM279,151L279,0L279,151z" fill="none"/></g><text class="st2"><tspan y="23.5" x="22">connector.getService()</tspan><tspan y="47.5" x="22">.getContainer()</tspan><tspan y="71.5" x="22">.getPipeline()</tspan><tspan y="95.5" x="22">.getFirst()</tspan><tspan y="119.5" x="22">.invoke(request, </tspan><tspan y="143.5" x="22">response);</tspan></text></g><g transform="translate(1914,277.75)"><path stroke="#ee7c31" d="M0,57.8L0,0L321,0L321,57.8C268.1,46.8,213.4,46.8,160.5,57.8C107.6,68.7,52.9,68.7,0,57.8z" fill="#ee7c31" id="shape28"/><text class="st5"><tspan y="46" x="49">StandardEngine</tspan></text></g><g transform="translate(1942,825.75)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#92d050" id="shape29"/><text class="st1"><tspan y="36" x="23">StandardEngineValve</tspan></text></g><g transform="translate(1924,494.75)"><path stroke="#92d050" d="M302,416L302,0L0,0L0,416L302,416z" fill="#3498db" stroke-width="6.66667" id="shape30" fill-opacity="0"/></g><g transform="translate(1942,733.38)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#92d050" id="shape31"/><text class="st1"><tspan y="36" x="34">XxxxxxxxxxxxValve</tspan></text></g><g transform="translate(2069.5,789.38)" id="shape32"><path stroke="#ffc000" d="M0,0L0,25" fill="none" stroke-width="6.66667"/><path stroke="#ffc000" d="M0,36.4L7.7,23C5.5,24.3,2.8,25,0,25C-2.8,25,-5.5,24.3,-7.7,23L0,36.4" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(1942,647.5)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#92d050" id="shape33"/><text class="st1"><tspan y="36" x="34">XxxxxxxxxxxxValve</tspan></text></g><g transform="translate(1924,494.75)"><path stroke="#ee7c31" d="M0,49L0,0L283,0L283,49C236.3,39.7,188.2,39.7,141.5,49C94.8,58.3,46.7,58.3,0,49z" fill="#92d050" id="shape34"/><text class="st6"><tspan y="38.5" x="30">StandardPipeline</tspan></text></g><g transform="translate(2244,343.75)"><path stroke="#00b0f0" d="M1082,822L1082,0L0,0L0,822L1082,822z" fill="#3498db" stroke-width="6.66667" id="shape35" fill-opacity="0"/></g><g transform="translate(2229.99,343.75)"><path stroke="#2da2bf" d="M0,57.8L0,0L321,0L321,57.8C268.1,46.8,213.4,46.8,160.5,57.8C107.6,68.7,52.9,68.7,0,57.8z" fill="#2da2bf" id="shape36"/><text class="st5"><tspan y="46" x="65">StandardHost</tspan></text></g><g transform="translate(2248.99,494.75)"><path stroke="#00b0f0" d="M302,416L302,0L0,0L0,416L302,416z" fill="#3498db" stroke-width="6.66667" id="shape37" fill-opacity="0"/></g><g transform="translate(2266.99,647.5)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#2d85c1" id="shape38"/><text class="st1"><tspan y="36" x="34">XxxxxxxxxxxxValve</tspan></text></g><g transform="translate(2248.99,494.75)"><path stroke="#ee7c31" d="M0,49L0,0L283,0L283,49C236.3,39.7,188.2,39.7,141.5,49C94.8,58.3,46.7,58.3,0,49z" fill="#2d85c1" id="shape39"/><text class="st6"><tspan y="38.5" x="30">StandardPipeline</tspan></text></g><g transform="translate(2394.49,703.5)" id="shape40"><path stroke="#ffc000" d="M0,0L0,19.7" fill="none" stroke-width="5.33333"/><path stroke="#ffc000" d="M0,29.9L6.9,17.9C4.9,19.1,2.5,19.7,0,19.7C-2.5,19.7,-4.9,19.1,-6.9,17.9L0,29.9" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2266.99,733.38)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#2d85c1" id="shape41"/><text class="st1"><tspan y="36" x="34">XxxxxxxxxxxxValve</tspan></text></g><g transform="translate(2394.49,789.38)" id="shape42"><path stroke="#ffc000" d="M0,0L0,26.2" fill="none" stroke-width="5.33333"/><path stroke="#ffc000" d="M0,36.4L6.9,24.4C4.9,25.6,2.5,26.2,0,26.2C-2.5,26.2,-4.9,25.6,-6.9,24.4L0,36.4" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2266.99,825.75)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#2d85c1" id="shape43"/><text class="st1"><tspan y="36" x="34">StandardHostVavle</tspan></text></g><g transform="translate(2069.5,703.5)" id="shape44"><path stroke="#ffc000" d="M0,0L0,18.5" fill="none" stroke-width="6.66667"/><path stroke="#ffc000" d="M0,29.9L7.7,16.5C5.5,17.8,2.8,18.5,0,18.5C-2.8,18.5,-5.5,17.8,-7.7,16.5L0,29.9" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2069.5,881.75)" id="shape45"><path stroke="#ff0000" d="M0,0L0,66L165.5,66L165.5,-206.3L186.2,-206.3" fill="none" stroke-width="6.66667"/><path stroke="#ff0000" d="M197.5,-206.3L184.1,-214C185.4,-211.7,186.2,-209.1,186.2,-206.3C186.2,-203.4,185.4,-200.8,184.1,-198.5L197.5,-206.3" fill="#ff0000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2566,353.75)"><path stroke="#ffc000" d="M741,799.3L741,0L0,0L0,799.3L741,799.3z" fill="#3498db" stroke-width="6.66667" id="shape46" fill-opacity="0"/></g><g transform="translate(2566,353.75)"><path stroke="#2da2bf" d="M0,57.8L0,0L321,0L321,57.8C268.1,46.8,213.4,46.8,160.5,57.8C107.6,68.7,52.9,68.7,0,57.8z" fill="#ffc000" id="shape47"/><text class="st5"><tspan y="46" x="41">StandardContext</tspan></text></g><g transform="translate(2266.99,733.38)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#2d85c1" id="shape48"/><text class="st1"><tspan y="36" x="34">XxxxxxxxxxxxValve</tspan></text></g><g transform="translate(2585,494.75)"><path stroke="#00b0f0" d="M302,416L302,0L0,0L0,416L302,416z" fill="#3498db" stroke-width="6.66667" id="shape49" fill-opacity="0"/></g><g transform="translate(2603,825.75)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#ffc000" id="shape50"/><text class="st1"><tspan y="36" x="18">StandardContextVavle</tspan></text></g><g transform="translate(2603,733.38)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#ffc000" id="shape51"/><text class="st1"><tspan y="36" x="34">XxxxxxxxxxxxValve</tspan></text></g><g transform="translate(2603,647.5)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#ffc000" id="shape52"/><text class="st1"><tspan y="36" x="34">XxxxxxxxxxxxValve</tspan></text></g><g transform="translate(2730.5,703.5)" id="shape53"><path stroke="#ffc000" d="M0,0L0,19.7" fill="none" stroke-width="5.33333"/><path stroke="#ffc000" d="M0,29.9L6.9,17.9C4.9,19.1,2.5,19.7,0,19.7C-2.5,19.7,-4.9,19.1,-6.9,17.9L0,29.9" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2730.5,789.38)" id="shape54"><path stroke="#ffc000" d="M0,0L0,26.2" fill="none" stroke-width="5.33333"/><path stroke="#ffc000" d="M0,36.4L6.9,24.4C4.9,25.6,2.5,26.2,0,26.2C-2.5,26.2,-4.9,25.6,-6.9,24.4L0,36.4" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2589,494.75)"><path stroke="#ee7c31" d="M0,49L0,0L283,0L283,49C236.3,39.7,188.2,39.7,141.5,49C94.8,58.3,46.7,58.3,0,49z" fill="#ffc000" id="shape55"/><text class="st6"><tspan y="38.5" x="30">StandardPipeline</tspan></text></g><g transform="translate(2394.49,881.75)" id="shape56"><path stroke="#ffc000" d="M0,0L0,57L142.5,57L142.5,-206.3L198.4,-206.3" fill="none" stroke-width="5.33333"/><path stroke="#ffc000" d="M208.5,-206.3L196.5,-213.2C197.7,-211.1,198.4,-208.8,198.4,-206.3C198.4,-203.7,197.7,-201.4,196.5,-199.3L208.5,-206.3" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2901,406)"><path stroke="#92d050" d="M397,728L397,0L0,0L0,728L397,728z" fill="#3498db" stroke-width="6.66667" id="shape57" fill-opacity="0"/></g><g transform="translate(2901,406)"><path stroke="#2da2bf" d="M0,57.8L0,0L321,0L321,57.8C268.1,46.8,213.4,46.8,160.5,57.8C107.6,68.7,52.9,68.7,0,57.8z" fill="#92d050" id="shape58"/><text class="st5"><tspan y="46" x="41">StandardWrapper</tspan></text></g><g transform="translate(2910.5,494.75)"><path stroke="#92d050" d="M377.5,416L377.5,0L0,0L0,416L377.5,416z" fill="#3498db" stroke-width="6.66667" id="shape59" fill-opacity="0"/></g><g transform="translate(2910.5,494.75)"><path stroke="#ee7c31" d="M0,49L0,0L283,0L283,49C236.3,39.7,188.2,39.7,141.5,49C94.8,58.3,46.7,58.3,0,49z" fill="#92d050" id="shape60"/><text class="st6"><tspan y="38.5" x="65">FilterChain</tspan></text></g><g transform="translate(2910,595)"><g id="shape61"><path d="M369,151L369,0L0,0L0,151L369,151z" fill="#e8eff8"/><path stroke="#83b3e3" d="M369,151L369,0L0,0L0,151L369,151zM14,151L14,0L14,151zM355,151L355,0L355,151z" fill="none"/></g><text class="st4"><tspan y="48.5" x="22">OrderedCharacterEncodingFilter</tspan><tspan y="71.5" x="22">OrderedFormContentFilter</tspan><tspan y="94.5" x="22">OrderedRequestContextFilter</tspan><tspan y="117.5" x="22">WsFilter</tspan></text></g><g transform="translate(2967,767.88)"><path stroke="#3498db" d="M255,56L255,0L0,0L0,56L255,56z" fill="#ffc000" id="shape62"/><text class="st1"><tspan y="36" x="34">DispatcherServlet</tspan></text></g><g transform="translate(3094.5,746)" id="shape63"><path stroke="#236ea1" d="M0,0L0,17.5" fill="none"/><path stroke="#236ea1" d="M0,21.9L3,16.7C2.1,17.2,1.1,17.5,0,17.5C-1.1,17.5,-2.1,17.2,-3,16.7L0,21.9" fill="#236ea1" stroke-width="1" stroke-linecap="round"/></g><g transform="translate(2730.5,881.75)" id="shape64"><path stroke="#ffc000" d="M0,0L0,78.3L141.5,78.3L141.5,-111.8L160.4,-111.8" fill="none" stroke-width="5.33333"/><path stroke="#ffc000" d="M170.5,-111.8L158.5,-118.7C159.7,-116.6,160.4,-114.3,160.4,-111.8C160.4,-109.2,159.7,-106.9,158.5,-104.8L170.5,-111.8" fill="#ffc000" stroke-width="1" stroke-linecap="round"/></g></g></svg>